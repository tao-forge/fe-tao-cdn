define("tpl!taoRevision/controller/history/line",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing;return buffer+='<tr>\n    <td class="numeric">',buffer+=escapeExpression(stack1=(helper=helpers.id)||"function"==typeof(helper=depth0&&depth0.id)?helper.call(depth0,{hash:{},data:data}):helper)+'</td>\n    <td class="date">',buffer+=escapeExpression(stack1=(helper=helpers.modified)||"function"==typeof(
helper=depth0&&depth0.modified)?helper.call(depth0,{hash:{},data:data}):helper)+'</td>\n    <td class="user">',!(stack1=(helper=helpers.author)||"function"==typeof(helper=depth0&&depth0.author)?helper.call(depth0,{hash:{},data:data}):helper)&&0!==stack1||(buffer+=stack1),buffer+='</td>\n    <td class="message">',buffer+=escapeExpression(stack1=(helper=helpers.message)||"function"==typeof(helper=depth0&&depth0.message)?helper.call(depth0,{hash:{},data:data}):helper)+'</td>\n    <td class="actions">\n        <button class="btn-info small restore_revision" data-revision="',buffer+=escapeExpression(stack1=(helper=helpers.id)||"function"==typeof(
helper=depth0&&depth0.id)?helper.call(depth0,{hash:{},data:data}):helper)+'">\n            <span class="icon-undo"></span>\n            '+escapeExpression((options={hash:{},data:data},(helper=helpers.__||depth0&&depth0.__)?helper.call(depth0,"Restore",options):helperMissing.call(depth0,"__","Restore",options)))+"\n        </button>\n    </td>\n</tr>"})}),define("taoRevision/controller/history/index",["jquery","i18n","tpl!taoRevision/controller/history/line","helpers","ui/feedback","select2","ui/tooltip"],function($,__,lineTpl,helpers,feedback){"use strict";return{start:function(){var $container=$(".revision-container"),$form=$("form",$container),$submiter=$(
":submit",$form),$table=$("#revisions-table"),body=$table.find("tbody")[0];$form.on("submit",function(e){e.preventDefault(),e.stopImmediatePropagation()}),$submiter.on("click",function(e){e.preventDefault();var $message=$("#message",$form);""!==$message.val()?($submiter.addClass("disabled"),$.post($form.attr("action"),$form.serialize()).done(function(res){res&&res.success?(feedback().success(res.commitMessage),$(body).append(lineTpl(res))):feedback().error(__("Something went wrong..."))}).complete(function(){$submiter.removeClass("disabled"),$message.val("")})):feedback().error(__("Please give a message to your commit"))}),$table.on("click",
".restore_revision",function(event){var element,body,revision,id,message;event.preventDefault(),element=this,body=$("#revisions-table").find("tbody")[0],revision=$(element).data("revision"),id=$("#resource_id").val(),message=prompt("Please enter a message",__("Restored version %s",revision)),void 0!==revision&&void 0!==message&&null!=message&&""!==revision&&""!==message&&$.post(helpers._url("restoreRevision","History","taoRevision"),{id:id,revisionId:revision,message:message}).done(function(res){res&&res.success?(feedback().success(__("Resource restored")),$(body).append(lineTpl(res)),$(".tree").trigger("refresh.taotree")):feedback().error(__(
"Something went wrong..."))})})}}}),define("taoRevision/controller/routes",[],function(){return{History:{actions:{index:"controller/history/index"}}}}),define("taoRevision/loader/taoRevision.bundle",function(){});
//# sourceMappingURL=taoRevision.min.js.map